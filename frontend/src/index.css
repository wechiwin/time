@tailwind base;
@tailwind components;
@tailwind utilities;

@keyframes grid-scroll {
    0% {
        background-position: 0 0;
    }
    100% {
        background-position: 0 100%;
    }
}

/* 基础页面背景样式 */
.page-bg {
    @apply bg-slate-50 dark:bg-slate-950 text-slate-900 dark:text-slate-100;
    /* 添加微弱的网格纹理 */
    background-image: linear-gradient(to right, #e2e8f0 1px, transparent 1px),
    linear-gradient(to bottom, #e2e8f0 1px, transparent 1px);
    background-size: 40px 40px;
}

.dark .page-bg {
    background-image: linear-gradient(to right, rgba(30, 41, 59, 0.5) 1px, transparent 1px),
    linear-gradient(to bottom, rgba(30, 41, 59, 0.5) 1px, transparent 1px);
}

/* === 新增：Blob 动画 (用于背景装饰) === */
@keyframes blob {
    0% {
        transform: translate(0px, 0px) scale(1);
    }
    33% {
        transform: translate(30px, -50px) scale(1.1);
    }
    66% {
        transform: translate(-20px, 20px) scale(0.9);
    }
    100% {
        transform: translate(0px, 0px) scale(1);
    }
}

.animate-blob {
    animation: blob 7s infinite;
}

.animation-delay-2000 {
    animation-delay: 2s;
}

.animation-delay-4000 {
    animation-delay: 4s;
}

/* 全局表单控件样式 */
.input-field {
    @apply w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all;
}

/* 表格样式 */
.table-container {
    @apply overflow-x-auto border border-gray-200 rounded-lg
    max-w-full;
}

.table-header {
    @apply px-3 md:px-6 py-3 text-left text-xs font-medium text-gray-500 tracking-wider bg-gray-50;
}

.table-cell {
    @apply px-3 md:px-6 py-3 text-sm text-gray-500;
}

@layer components {
    /* 卡片或页面背景 */
    .page-bg {
        @apply bg-gray-50 dark:bg-gray-900;
    }

    /* 卡片 */
    .card {
        @apply bg-white dark:bg-slate-800/60 border border-slate-200 dark:border-slate-700/50
        rounded-xl shadow-sm backdrop-blur-sm;
        /* 加一点模糊效果 */
    }

    /* 表单输入框 */
    .input-field {
        @apply w-full pl-3 pr-4 py-2 border border-gray-300 dark:border-gray-600
        rounded-md shadow-sm focus:ring-2 focus:ring-blue-500
        focus:border-blue-500 bg-white dark:bg-gray-800
        text-gray-900 dark:text-gray-100;
    }

    .read-only-input {
        background-color: #f3f4f6; /* 浅灰色背景 */
        color: #6b7280; /* 灰色文字 */
        cursor: not-allowed;
        opacity: 1; /* 确保不透明 */
    }

    .dark .read-only-input {
        @apply bg-gray-700 text-gray-400;
    }

    .btn-group {
        @apply flex flex-wrap gap-2 w-full md:w-auto;
    }

    /* 主按钮 */
    .btn-primary {
        @apply px-4 py-2 bg-blue-600 text-white rounded-lg /* 圆角稍微加大 */
        hover:bg-blue-700
        focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 dark:focus:ring-offset-slate-900
        transition-all duration-150 shadow-sm hover:shadow-md;
        /* 增加过渡 */
    }

    .btn-primary:disabled,
    .btn-primary[disabled] {
        background-color: #9ca3af !important;
        color: #e5e7eb !important;
        cursor: not-allowed !important;
        opacity: 0.5 !important;
        box-shadow: none !important;
    }

    .btn-secondary {
        @apply px-4 py-2 bg-gray-200 dark:bg-gray-700
        text-gray-800 dark:text-gray-200
        rounded-md hover:bg-gray-300 dark:hover:bg-gray-600
        focus:outline-none focus:ring-2 focus:ring-gray-400;
    }

    .btn-secondary:disabled,
    .btn-secondary[disabled] {
        background-color: #d1d5db !important;
        color: #9ca3af !important;
        cursor: not-allowed !important;
        opacity: 0.5 !important;
    }

    .dark .btn-secondary:disabled,
    .dark .btn-secondary[disabled] {
        background-color: #4b5563 !important;
        color: #6b7280 !important;
    }

    /* 危险按钮 */
    .btn-danger {
        @apply px-4 py-2 bg-red-600 text-white rounded-md
        hover:bg-red-700
        focus:outline-none focus:ring-2 focus:ring-red-500;
    }

    .btn-danger:disabled,
    .btn-danger[disabled] {
        background-color: #9ca3af !important;
        color: #e5e7eb !important;
        cursor: not-allowed !important;
        opacity: 0.5 !important;
        box-shadow: none !important;
    }

    /* 用于次要或提示性操作的按钮 */
    .btn-subtle {
        @apply px-3 py-1.5 text-sm font-medium rounded-md transition-colors whitespace-nowrap
        bg-gray-100 text-gray-700 hover:bg-gray-200
        dark:bg-gray-700 dark:text-gray-200 dark:hover:bg-gray-600
        focus:outline-none focus:ring-2 focus:ring-blue-500;
    }

    /* 表格容器 */
    .table-container {
        @apply overflow-x-auto border border-gray-200 dark:border-gray-700 rounded-lg;
        -webkit-overflow-scrolling: touch;
    }

    /* 表头 */
    .table-header {
        @apply px-3 py-3 md:px-6 text-xs md:text-sm font-semibold
        text-slate-600 dark:text-slate-300
        tracking-wider text-left
        bg-slate-100 dark:bg-slate-800/50 /* 调整表头背景 */
        border-b border-slate-200 dark:border-slate-700;
    }

    /* 单元格 */
    .table-cell {
        @apply px-3 py-2 md:px-6 md:py-4 whitespace-nowrap
        text-xs md:text-sm text-slate-700 dark:text-slate-300
        border-b border-slate-100 dark:border-slate-700/50;
        /* 调整边框颜色 */
    }

    /* 搜索区容器：flex 布局、间距、右端按钮组自动靠右 */
    .search-bar {
        @apply flex flex-col md:flex-row items-stretch md:items-center gap-2;
    }

    /* 搜索输入框：宽度、圆角、边框、focus 状态 */
    .search-input {
        @apply w-full md:w-64 lg:w-96 px-3 py-2 border border-gray-300 rounded-md
        focus:outline-none focus:ring-2 focus:ring-blue-500
        dark:border-gray-600 dark:bg-gray-800 dark:text-gray-100;
    }

    /* 对比基金标签 */
    .tag {
        @apply inline-flex items-center px-2 py-1 rounded-full text-sm
        bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200;
    }

    .tag .remove {
        @apply ml-1 text-blue-600 dark:text-blue-300 hover:text-blue-800 dark:hover:text-blue-100;
    }

    .search-area-label {
        font-size: 0.875rem; /* 14px */
        font-weight: 500;
        color: #374151; /* gray-700 */
        margin-bottom: 0.25rem;
    }

    .dark .search-area-label {
        color: #d1d5db; /* gray-300 */
    }

    /* 自定义滚动条样式，适配亮色/暗色模式 */
    .custom-scrollbar::-webkit-scrollbar {
        @apply w-1.5;
        /* 滚动条宽度 */
    }

    .custom-scrollbar::-webkit-scrollbar-track {
        @apply bg-transparent;
        /* 轨道背景透明 */
    }

    .custom-scrollbar::-webkit-scrollbar-thumb {
        @apply rounded-full bg-gray-300;
        /* 亮色模式滑块 */
    }

    .dark .custom-scrollbar::-webkit-scrollbar-thumb {
        @apply bg-gray-600;
        /* 暗色模式滑块 */
    }

    .custom-scrollbar::-webkit-scrollbar-thumb:hover {
        @apply bg-gray-400;
        /* 亮色模式滑块 hover */
    }

    .dark .custom-scrollbar::-webkit-scrollbar-thumb:hover {
        @apply bg-gray-500;
        /* 暗色模式滑块 hover */
    }

    /* React Select 样式 */
    .react-multi-select .select__control {
        border-radius: 0.375rem;
        font-size: 0.875rem;
        line-height: 1.25rem;
    }

    .react-multi-select .select__control--is-focused {
        border-color: #3b82f6 !important;
        box-shadow: 0 0 0 2px rgba(59, 130, 246, 0.1) !important;
    }

    .react-multi-select .select__menu {
        border-radius: 0.375rem;
        border: 1px solid #e5e7eb;
        box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
    }

    .react-multi-select .select__option {
        padding: 0.5rem 0.75rem;
        cursor: pointer;
    }

    .react-multi-select .select__option--is-focused {
        background-color: #eff6ff;
    }

    .react-multi-select .select__option--is-selected {
        background-color: #3b82f6;
        color: white;
    }

    .react-multi-select .select__multi-value {
        background-color: #dbeafe;
        border-radius: 0.25rem;
    }

    .react-multi-select .select__multi-value__label {
        color: #1e40af;
        font-weight: 500;
    }

    .react-multi-select .select__multi-value__remove {
        color: #1e40af;
    }

    .react-multi-select .select__multi-value__remove:hover {
        background-color: #bfdbfe;
        color: #dc2626;
    }

    .react-multi-select .select__indicator-separator {
        background-color: #d1d5db;
    }

    .react-multi-select .select__dropdown-indicator {
        color: #9ca3af;
    }

    .react-multi-select .select__dropdown-indicator:hover {
        color: #6b7280;
    }

    .react-multi-select .select__clear-indicator {
        color: #9ca3af;
        padding: 4px;
    }

    .react-multi-select .select__clear-indicator:hover {
        color: #dc2626;
    }

    /* 暗色模式支持 */
    .dark .react-multi-select .select__control {
        background-color: #1f2937;
        border-color: #4b5563;
        color: #f9fafb;
    }

    .dark .react-multi-select .select__single-value {
        color: #f9fafb;
    }

    .dark .react-multi-select .select__input {
        color: #f9fafb;
    }

    .dark .react-multi-select .select__menu {
        background-color: #1f2937;
        border-color: #4b5563;
    }

    .dark .react-multi-select .select__option {
        color: #f9fafb;
    }

    .dark .react-multi-select .select__option--is-focused {
        background-color: #374151;
        color: #f9fafb;
    }

    .dark .react-multi-select .select__option--is-selected {
        background-color: #3b82f6;
        color: white;
    }

    .dark .react-multi-select .select__multi-value {
        background-color: #374151;
    }

    .dark .react-multi-select .select__multi-value__label {
        color: #93c5fd;
    }

    .dark .react-multi-select .select__placeholder {
        color: #9ca3af;
    }

    .dark .react-multi-select .select__indicator {
        color: #9ca3af;
    }

    .dark .react-multi-select .select__indicator:hover {
        color: #d1d5db;
    }

    /* 在 index.css 的 dark .react-multi-select 部分添加 */
    .dark .react-multi-select .select__indicator-separator {
        background-color: #374151;
    }

    .dark .react-multi-select .select__multi-value {
        background-color: #1e3a8a; /* 更深的蓝色背景 */
    }

    .dark .react-multi-select .select__multi-value__label {
        color: #93c5fd; /* 更亮的蓝色文字 */
    }

    .dark .react-multi-select .select__multi-value__remove {
        color: #93c5fd; /* 亮色关闭图标 */
    }

    .dark .react-multi-select .select__multi-value__remove:hover {
        background-color: #7f1d1d; /* 深红色背景 */
        color: #fca5a5; /* 亮红色图标 */
    }

    .dark .react-multi-select .select__control {
        background-color: #1f2937;
        border-color: #4b5563;
        color: #f9fafb;
    }

    .dark .react-multi-select .select__control--is-focused {
        border-color: #3b82f6 !important;
        box-shadow: 0 0 0 2px rgba(59, 130, 246, 0.3) !important;
    }

    .dark .react-multi-select .select__single-value {
        color: #f9fafb;
    }

    .dark .react-multi-select .select__input {
        color: #f9fafb;
    }

    .dark .react-multi-select .select__menu {
        background-color: #1f2937;
        border-color: #4b5563;
    }

    .dark .react-multi-select .select__option {
        color: #f9fafb;
    }

    .dark .react-multi-select .select__option--is-focused {
        background-color: #374151;
        color: #f9fafb;
    }

    .dark .react-multi-select .select__option--is-selected {
        background-color: #3b82f6;
        color: white;
    }

    .dark .react-multi-select .select__placeholder {
        color: #9ca3af;
    }

    .dark .react-multi-select .select__indicator {
        color: #9ca3af;
    }

    .dark .react-multi-select .select__indicator:hover {
        color: #d1d5db;
    }

    .dark .react-multi-select .select__clear-indicator {
        color: #9ca3af;
    }

    .dark .react-multi-select .select__clear-indicator:hover {
        color: #fca5a5; /* 亮红色 */
    }

    .chart-box {
        @apply w-full min-h-[300px] md:min-h-[400px] flex items-center justify-center;
    }

    .chart-box .loading {
        @apply text-gray-500 dark:text-gray-400 text-sm;
    }

    .react-datepicker {
        transform: scale(0.9);
        transform-origin: top left;
    }

    .react-datepicker__year-select,
    .react-datepicker__month-select {
        @apply px-3 h-8 text-sm rounded-md border border-slate-300;
    }

    /* =========================================
       React DatePicker 暗黑模式支持
       ========================================= */
    /* 1. 弹窗容器：背景、边框、文字颜色 */
    .dark .react-datepicker {
        @apply bg-gray-800 border-gray-600 text-gray-300 rounded-lg shadow-lg;
        border-width: 1px; /* 确保边框显示 */
    }

    /* 2. 弹窗小箭头 */
    .dark .react-datepicker__triangle::before,
    .dark .react-datepicker__triangle::after {
        /* 核心：让箭头颜色与弹窗背景色一致 */
        border-bottom-color: #374151 !important; /* gray-700 */
    }

    .dark .react-datepicker__triangle::before {
        border-bottom-color: #4b5563 !important; /* gray-600, for border */
    }

    /* 3. 头部区域：背景、边框 */
    .dark .react-datepicker__header {
        @apply bg-gray-700 border-b-gray-600;
    }

    /* 4. 当前月份文字 */
    .dark .react-datepicker__current-month {
        @apply text-gray-100;
    }

    /* 5. 星期标题 (Su, Mo...) */
    .dark .react-datepicker__day-name {
        @apply text-gray-400;
    }

    /* 6. 日期单元格 */
    .dark .react-datepicker__day {
        @apply text-gray-200;
    }

    /* 7. 日期单元格 Hover 状态 */
    .dark .react-datepicker__day:hover,
    .dark .react-datepicker__month-text:hover,
    .dark .react-datepicker__year-text:hover {
        @apply bg-gray-600 text-white rounded-md;
    }

    /* 8. 禁用日期 */
    .dark .react-datepicker__day--disabled {
        @apply text-gray-500 cursor-default hover:bg-transparent;
    }

    /* 9. 选中日期 */
    .dark .react-datepicker__day--selected,
    .dark .react-datepicker__day--keyboard-selected {
        @apply bg-blue-600 text-white hover:bg-blue-700 rounded-md;
    }

    /* 10. 今日日期高亮 */
    .dark .react-datepicker__day--today {
        @apply font-bold text-blue-400;
    }

    /* 11. 导航箭头 */
    .dark .react-datepicker__navigation-icon::before {
        border-color: #d1d5db; /* gray-300 */
        border-width: 2px 2px 0 0;
    }

    .dark .react-datepicker__navigation:hover .react-datepicker__navigation-icon::before {
        border-color: #ffffff;
    }

    /* 12. 【关键修复】年月下拉框 */
    .dark .react-datepicker__year-select,
    .dark .react-datepicker__month-select {
        @apply bg-gray-800 text-gray-100 border-gray-600 rounded-md;
    }

    /* 13. 【关键修复】确保 DatePicker 的输入框在暗黑模式下样式正确 */
    /*
       DatePicker 的 input 是被一个 div.react-datepicker-wrapper 包裹的，
       我们需要确保我们的暗黑模式样式能够正确应用到这个 input 上。
       这里的选择器确保了高优先级。
    */
    .dark .react-datepicker-wrapper .input-field {
        @apply bg-gray-800 text-gray-100 border-gray-600;
    }

    .dark .react-datepicker-wrapper .input-field:focus {
        @apply ring-blue-500 border-blue-500;
    }

    /* =========================================
   自定义滚动条样式 - 适配暗黑模式
   ========================================= */
    /* Firefox 滚动条样式 */
    .table-container,
    main {
        scrollbar-width: thin;
        scrollbar-color: rgb(209 213 219) rgb(243 244 246); /* gray-300 gray-100 */
    }

    .dark .table-container,
    .dark main {
        scrollbar-color: rgb(75 85 99) rgb(31 41 55); /* gray-600 gray-800 */
    }

    /* Webkit 浏览器滚动条样式 (Chrome, Safari, Edge) */
    .table-container::-webkit-scrollbar,
    main::-webkit-scrollbar {
        width: 8px;
        height: 8px;
    }

    .table-container::-webkit-scrollbar-track,
    main::-webkit-scrollbar-track {
        background: rgb(243 244 246); /* gray-100 */
        border-radius: 4px;
    }

    .dark .table-container::-webkit-scrollbar-track,
    .dark main::-webkit-scrollbar-track {
        background: rgb(31 41 55); /* gray-800 */
        border-radius: 4px;
    }

    .table-container::-webkit-scrollbar-thumb,
    main::-webkit-scrollbar-thumb {
        background: rgb(209 213 219); /* gray-300 */
        border-radius: 4px;
    }

    .dark .table-container::-webkit-scrollbar-thumb,
    .dark main::-webkit-scrollbar-thumb {
        background: rgb(75 85 99); /* gray-600 */
        border-radius: 4px;
    }

    .table-container::-webkit-scrollbar-thumb:hover,
    main::-webkit-scrollbar-thumb:hover {
        background: rgb(156 163 175); /* gray-400 */
    }

    .dark .table-container::-webkit-scrollbar-thumb:hover,
    .dark main::-webkit-scrollbar-thumb:hover {
        background: rgb(107 114 128); /* gray-500 */
    }

    /* 确保滚动条在需要时显示 */
    .table-container {
        overflow-x: auto;
    }

    main {
        overflow-y: auto;
    }

    /* 移动端优化 */
    @media (max-width: 768px) {
        /* 模态框全屏 */
        .modal-container {
            @apply w-full h-full max-w-none rounded-none;
        }

        /* 表格单元格缩小内边距 */
        .table-cell {
            @apply px-2 py-2 text-xs;
        }

        /* 按钮文字不换行 */
        .btn-primary, .btn-secondary, .btn-danger {
            @apply whitespace-nowrap text-sm;
        }

        /* 表单按钮垂直排列 */
        .form-actions {
            @apply flex-col space-y-2 space-x-0 w-full;
        }

        /* 图表高度调整 */
        .chart-box {
            @apply min-h-[250px];
        }

        /* 移动端触摸友好的按钮 */
        .touch-button {
            @apply px-4 py-3 text-base;
        }

        /* 移动端滚动优化 */
        .scroll-container {
            -webkit-overflow-scrolling: touch;
        }

        /* 移动端字体大小 */
        body {
            font-size: 14px;
        }

        .pagination-container {
            @apply gap-4 p-4;
        }

        /* 移动端分页按钮更大 */
        .pagination-button {
            @apply p-3;
        }

        /* 移动端当前页信息更大 */
        .pagination-current {
            @apply text-base px-4 py-3;
        }

        /* 移动端输入框更大 */
        .pagination-input {
            @apply w-20 py-3 text-base;
        }

        /* 移动端下拉菜单更大 */
        .pagination-select {
            @apply py-3 text-base;
        }
    }

    /* 移动端触摸目标样式 */
    .touch-target {
        min-height: 48px; /* 确保触摸目标至少48px高 */
        min-width: 48px; /* 确保触摸目标至少48px宽 */
    }

    /* 移动端输入框样式 */
    .touch-input {
        min-height: 48px; /* 确保输入框至少48px高 */
    }

    /* 表单输入框图标适配 */
    .input-icon {
        @apply absolute inset-y-0 left-0 flex items-center pl-3 pointer-events-none;
    }

    /* 移动端友好的下拉菜单 */
    .mobile-select {
        @apply block w-full px-3 py-2 text-base border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500;
    }

    /* 触摸友好的按钮 */
    .touch-button {
        @apply px-4 py-3 text-base;
        /* 更大的点击区域 */
    }

    /* 移动端导航优化 */
    .mobile-nav {
        @apply fixed inset-0 bg-white z-50 overflow-y-auto;
    }

    /* 移动端列表项 */
    .mobile-list-item {
        @apply p-3 border-b border-gray-200 last:border-b-0;
    }

    /* 移动端间距优化 */
    .mobile-padding {
        @apply p-3;
    }

    .mobile-margin {
        @apply m-3;
    }
}
